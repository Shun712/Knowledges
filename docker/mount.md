# マウント

Dockerにおける「マウント」とは、コンテナの外にあるデータを、コンテナの中で利用できる状態にすることを意味する。

### ボリュームマウント

- ボリュームが作成されると、Dockerホストのディレクトリに作成される。

- ボリュームがコンテナにマウントされると、このディレクトリはコンテナにマウントされる。

- `bind Mount`と違い、ボリュームはDockerによって管理され、ホストマシンのコア機能から分離される。

- ボリュームは複数のコンテナに同時マウントできる。

- 実行中のコンテナにボリュームを使用してない場合でも、ボリュームは引き続き使用でき、自動的に削除されない。

  - `docker system prune`で削除できる。

### バインドマウント

- バインドマウントはボリュームと比べて機能が限られている。

  - バインドマウントを使用すると、ホストマシン上のファイルやディレクトリはコンテナにマウントされる。

  - マウント対象のファイルやディレクトリはホストマシン上の絶対パス(full path)によって参照される。

# マウントの使用例

### ボリュームマウント

- 複数の実行中のコンテナ間でデータを共有したい時

  - 複数のコンテナが読み取り専用か読み書きのいずれかで同時マウントできる

- Dockerホストが特定のディレクトリまたはファイル構造を持つことが保証されている時

  - ホストのファイルたディレクトリ等の構成を実行中のコンテナから分離することがボリュームにはできる

- ローカルではなく、リモートホストやクラウドプロバイダーに保存する場合

- あるDockerホストから別のDockerホストにデータ移行、復元、バックアップしたい場合。

### バインドマウント

- 一般にできるだけボリュームを使用すべきと公式リファレンスで述べられている。

- ホストマシンからコンテナへの構成（ファイルやディレクトリ構成）を共有したい場合

  - ホストマシンから各コンテナに`etc/resolv.conf`をマウントすることにより、DockerがデフォルトでコンテナにDNS解決を提供することができる。

- ソースコードや作成したアーティファクトをDockerホストとコンテナ間で共有したい場合

  - 例えば、Mavenの`target/`ディレクトリをマウントした場合に、DockerホストでMavenプロジェクトをビルドする度にコンテナは再構築sれたアーティファクトにアクセスする

- Dockerホストのファイルやディレクトリ構成が、コンテナが必要とするバインドマウントに一致することが保証されている場合

# 参考

[Dockerのマウント3種類についてわかったことをまとめる - qiita](https://qiita.com/y518gaku/items/456f34c317a65a9dae86)

